package tech.pegasys.poc.witnesscodeanalysis;

import org.apache.logging.log4j.Logger;
import org.apache.tuweni.bytes.Bytes;
import java.util.Set;

import static org.apache.logging.log4j.LogManager.getLogger;

public class WitnessCodeAnalysis {
  private static final Logger LOG = getLogger();

  // Contract that had 25% of all transactions submitted to it.
  // https://etherscan.io/address/0xd94ea6e43b7bffc9e4cba93f3ca49a191dc06d90#code
  // Source code in Swarm: bzzr://1b04e436f7973257b6d6873e0d68b3140e200a97b6628689798809969eb0521b
  public final static String contract_0xd94ea6e43b7bffc9e4cba93f3ca49a191dc06d90_InitCode =
      "6080604052670de0b6b3a7640000600055670de0b6b3a7640000600355731d8c188e2ec17a4723216b26531fbf59713556ec600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550733840679cbba3e940c0b9cc4a9801b6ae9a90e592600560006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060006006556000600755426008556000600a55600a600b5562015180600e556000600f55600160105567d02ab486cedc000060175568056bc75e2d6310000060185567d02ab486cedc00006019556001601a556001601b553480156200012b57600080fd5b506200013c6200018260201b60201c565b600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506200018a565b600033905090565b615f45806200019a6000396000f3fe";
  public final static String contract_0xd94ea6e43b7bffc9e4cba93f3ca49a191dc06d90 =
      "6080604052600436106101cd5760003560e01c806387c5d5cc116100f7578063bb5f747b11610095578063eb27def611610064578063eb27def614610e2b578063f11c25ba14610e84578063f2fde38b14610eb3578063f7ad55d914610f04576101cd565b8063bb5f747b14610c61578063db4acb6414610cca578063e08f079714610dc5578063e0d7cb6f14610e14576101cd565b80639160ec55116100d15780639160ec5514610aac5780639e01d1b914610b075780639e64f86714610b1e578063a145122414610b59576101cd565b806387c5d5cc1461088b5780638a03ad8614610a025780638f32d59b14610a7d576101cd565b8063578d714b1161016f5780637362d9c81161013e5780637362d9c814610766578063749aa2d9146107b757806375eeadcd146107ce57806383f6f9df14610813576101cd565b8063578d714b146105bf5780635a64130a1461069f5780636897e974146106da5780637266fada1461072b576101cd565b8063423e3071116101ab578063423e3071146103a557806347118798146103bc57806348fff6921461052b57806353501a9c14610584576101cd565b80631dfe52db146101cf57806326eebf41146101fa5780633746332b14610253575b005b3480156101db57600080fd5b506101e4610f53565b6040518082815260200191505060405180910390f35b34801561020657600080fd5b5061023d6004803603604081101561021d57600080fd5b810190808035906020019092919080359060200190929190505050610f59565b6040518082815260200191505060405180910390f35b6103a36004803603604081101561026957600080fd5b810190808035906020019064010000000081111561028657600080fd5b82018360208201111561029857600080fd5b803590602001918460018302840111640100000000831117156102ba57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561031d57600080fd5b82018360208201111561032f57600080fd5b8035906020019184600183028401116401000000008311171561035157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611031565b005b3480156103b157600080fd5b506103ba6119b3565b005b3480156103c857600080fd5b50610415600480360360408110156103df57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050611a37565b6040518084600f60200280838360005b83811015610440578082015181840152602081019050610425565b505050509050018060200180602001838103835285818151815260200191508051906020019080838360005b8381101561048757808201518184015260208101905061046c565b50505050905090810190601f1680156104b45780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b838110156104ed5780820151818401526020810190506104d2565b50505050905090810190601f16801561051a5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b34801561053757600080fd5b5061056e6004803603604081101561054e57600080fd5b8101908080359060200190929190803590602001909291905050506124cc565b6040518082815260200191505060405180910390f35b34801561059057600080fd5b506105bd600480360360208110156105a757600080fd5b810190808035906020019092919050505061258b565b005b3480156105cb57600080fd5b50610685600480360360208110156105e257600080fd5b81019080803590602001906401000000008111156105ff57600080fd5b82018360208201111561061157600080fd5b8035906020019184600183028401116401000000008311171561063357600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050612704565b604051808215151515815260200191505060405180910390f35b3480156106ab57600080fd5b506106d8600480360360208110156106c257600080fd5b81019080803590602001909291905050506127b6565b005b3480156106e657600080fd5b50610729600480360360208110156106fd57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061287a565b005b34801561073757600080fd5b506107646004803603602081101561074e57600080fd5b810190808035906020019092919050505061290b565b005b34801561077257600080fd5b506107b56004803603602081101561078957600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061298f565b005b3480156107c357600080fd5b506107cc612a20565b005b3480156107da57600080fd5b50610811600480360360408110156107f157600080fd5b810190808035906020019092919080359060200190929190505050612b5b565b005b34801561081f57600080fd5b506108286135b1565b604051808d81526020018c81526020018b81526020018a81526020018981526020018881526020018781526020018681526020018581526020018481526020018381526020018281526020019c5050505050505050505050505060405180910390f35b34801561089757600080fd5b506109e8600480360360408110156108ae57600080fd5b81019080803590602001906401000000008111156108cb57600080fd5b8201836020820111156108dd57600080fd5b803590602001918460018302840111640100000000831117156108ff57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561096257600080fd5b82018360208201111561097457600080fd5b8035906020019184600183028401116401000000008311171561099657600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050613649565b604051808215151515815260200191505060405180910390f35b348015610a0e57600080fd5b50610a3b60048036036020811015610a2557600080fd5b8101908080359060200190929190505050613749565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610a8957600080fd5b50610a92613801565b604051808215151515815260200191505060405180910390f35b348015610ab857600080fd5b50610b0560048036036040811015610acf57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050613860565b005b348015610b1357600080fd5b50610b1c6139b1565b005b348015610b2a57600080fd5b50610b5760048036036020811015610b4157600080fd5b8101908080359060200190929190505050613e82565b005b348015610b6557600080fd5b50610c1f60048036036020811015610b7c57600080fd5b8101908080359060200190640100000000811115610b9957600080fd5b820183602082011115610bab57600080fd5b80359060200191846001830284011164010000000083111715610bcd57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050613f00565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610c6d57600080fd5b50610cb060048036036020811015610c8457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061400e565b604051808215151515815260200191505060405180910390f35b348015610cd657600080fd5b50610dc360048036036060811015610ced57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190640100000000811115610d2a57600080fd5b820183602082011115610d3c57600080fd5b80359060200191846001830284011164010000000083111715610d5e57600080fd5b909192939192939080359060200190640100000000811115610d7f57600080fd5b820183602082011115610d9157600080fd5b80359060200191846001830284011164010000000083111715610db357600080fd5b909192939192939050505061403a565b005b348015610dd157600080fd5b50610dfe60048036036020811015610de857600080fd5b81019080803590602001909291905050506145d8565b6040518082815260200191505060405180910390f35b348015610e2057600080fd5b50610e2961461a565b005b348015610e3757600080fd5b50610e6e60048036036040811015610e4e57600080fd5b81019080803590602001909291908035906020019092919050505061498c565b6040518082815260200191505060405180910390f35b348015610e9057600080fd5b50610e99614a3f565b604051808215151515815260200191505060405180910390f35b348015610ebf57600080fd5b50610f0260048036036020811015610ed657600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050614a59565b005b348015610f1057600080fd5b50610f3d60048036036020811015610f2757600080fd5b8101908080359060200190929190505050614b9d565b6040518082815260200191505060405180910390f35b60065481565b6000600183148015610f6b5750600182145b15610f79576032905061102b565b600283148015610f895750600182145b15610f97576046905061102b565b600283148015610fa75750600282145b15610fb557601e905061102b565b6003831415611026576001821415610fd0576064905061102b565b6002821415610fe2576032905061102b565b6003821415610ff457601e905061102b565b600482101580156110065750600a8211155b15611014576005905061102b565b600b8210611025576001905061102b565b5b600090505b92915050565b60003390506000813b9050600081146110b2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f736f7272792068756d616e73206f6e6c7900000000000000000000000000000081525060200191505060405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff163273ffffffffffffffffffffffffffffffffffffffff1614611153576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f736f7272792c2068756d616e73206f6e6c79000000000000000000000000000081525060200191505060405180910390fd5b61115b614a3f565b6111cd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f6e6f2c20646f6e6e6f74696d697461746500000000000000000000000000000081525060200191505060405180910390fd5b60035460010234101580156111e75750600354600f023411155b611259576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6265747765656e203120616e642031350000000000000000000000000000000081525060200191505060405180910390fd5b61128260035461127460035434614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b34146112f6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f696e76616c6964206d73672076616c756500000000000000000000000000000081525060200191505060405180910390fd5b6000601360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002090506000816000015414156116135761135f8560405180602001604052806000815250613649565b15801561136d575060068551145b6113df576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f696e76616c696420696e7669746520636f64650000000000000000000000000081525060200191505060405180910390fd5b60006014856040518082805190602001908083835b6020831061141757805182526020820191506020810190506020830392506113f4565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905061147685612704565b6114e8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6265436f6465206e6f742065786973740000000000000000000000000000000081525060200191505060405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16141561158a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f6265436f6465416464722063616e27742062652073656c66000000000000000081525060200191505060405180910390fd5b61159386612704565b15611606576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f696e7669746520636f646520697320757365640000000000000000000000000081525060200191505060405180910390fd5b611611338787614d11565b505b60008061161e614ee8565b1561162b5734905061162f565b3491505b600060126000601054815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060008160000154146117925760006116ae82600401548360030154614ef590919063ffffffff16565b14611721576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6f6e6c79206f6e636520696e766573740000000000000000000000000000000081525060200191505060405180910390fd5b8281600301819055508181600401819055506117428160030154600261498c565b816008018190555061178561177e826004015461177084600201548560030154614ef590919063ffffffff16565b614ef590919063ffffffff16565b600161498c565b816009018190555061189b565b83600001548160000181905550338160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508281600301819055506117f683600261498c565b816008018190555081816004018190555061184261183b826004015461182d84600201548560030154614ef590919063ffffffff16565b614ef590919063ffffffff16565b600161498c565b81600901819055508360020181600c019080546001816001161561010002031660029004611871929190615bc4565b508360030181600d019080546001816001161561010002031660029004611899929190615bc4565b505b6118c46001600c6000601054815260200190815260200160002054614ef590919063ffffffff16565b600c600060105481526020019081526020016000208190555061190534600d6000601054815260200190815260200160002054614ef590919063ffffffff16565b600d6000601054815260200190815260200160002081905550611926614ee8565b6119655761193334614f7d565b6119608160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16614ffc565b6119a9565b601160006010548152602001908152602001600020816000015490806001815401808255809150509060018203906000526020600020016000909192909190915055505b5050505050505050565b6119bb613801565b611a2d576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b6000601a81905550565b611a3f615c4b565b606080611a4b3361400e565b80611a8157508473ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b611ad6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526029815260200180615e656029913960400191505060405180910390fd5b6000841415611ae55760105493505b611aed615c6e565b601360008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206040518060a0016040529081600082015481526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600282018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611c305780601f10611c0557610100808354040283529160200191611c30565b820191906000526020600020905b815481529060010190602001808311611c1357829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611cd25780601f10611ca757610100808354040283529160200191611cd2565b820191906000526020600020905b815481529060010190602001808311611cb557829003601f168201915b505050505081526020016004820154815250509050611cef615cb3565b6012600087815260200190815260200160002060008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060405180610220016040529081600082015481526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016002820154815260200160038201548152602001600482015481526020016005820154815260200160068201548152602001600782015481526020016008820154815260200160098201548152602001600a8201548152602001600b8201548152602001600c82018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611ea85780601f10611e7d57610100808354040283529160200191611ea8565b820191906000526020600020905b815481529060010190602001808311611e8b57829003601f168201915b50505050508152602001600d82018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015611f4a5780601f10611f1f57610100808354040283529160200191611f4a565b820191906000526020600020905b815481529060010190602001808311611f2d57829003601f168201915b50505050508152602001600e8201548152602001600f820154815260200160108201548152505090508160000151856000600f8110611f8557fe5b6020020181815250508060800151856001600f8110611fa057fe5b6020020181815250508060400151856002600f8110611fbb57fe5b6020020181815250508060600151856003600f8110611fd657fe5b6020020181815250508060a00151856004600f8110611ff157fe5b6020020181815250508060e00151856005600f811061200c57fe5b602002018181525050806101200151856006600f811061202857fe5b6020020181815250508060c00151856007600f811061204357fe5b602002018181525050806101c00151856008600f811061205f57fe5b602002018181525050806101600151856009600f811061207b57fe5b60200201818152505080610100015185600a600f811061209757fe5b6020020181815250506000809050600082600001511180156120c55750670de0b6b3a7640000826060015110155b80156120d75750601754826060015111155b80156120e857506007826101600151105b80156120f957506001836080015114155b15612108578160c00151810190505b600083608001511415612441576000809050612122615d4d565b6016600060105481526020019081526020016000206000856020015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000856101c0015181526020019081526020016000206040518060600160405290816000820154815260200160018201548152602001600282015481525050905060006121ec85608001516121de87604001518860600151614ef590919063ffffffff16565b614ef590919063ffffffff16565b9050670de0b6b3a7640000811061243d57600061221460035483614bdf90919063ffffffff16565b9050600f811061222c57826040015184019350612436565b60018661012001511480156122495750670de0b6b3a76400008210155b8015612259575060008360000151115b156122a05761229b600261228d8361227f600f8860000151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b840193505b60028661012001511480156122bd5750670de0b6b3a76400008210155b80156122dc57506000836000015111806122db575060008360200151115b5b1561238a57612331600a612323600761231585612307600f8a60000151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b84019350612385600761237760056123698561235b600f8a60200151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b840193505b60038661012001511480156123a75750670de0b6b3a76400008210155b80156123b7575060008360400151115b156123eb576123e6816123d8600f8660400151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b840193505b600386610120015110156124355760006124098761012001516145d8565b9050612431600a6124238388614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b9450505b5b8385019450505b5050505b8086600b600f811061244f57fe5b602002018181525050816101e0015186600c600f811061246b57fe5b602002018181525050826080015186600d600f811061248657fe5b60200201818152505081610200015186600e600f81106124a257fe5b60200201818152505085836040015184606001518191508090509550955095505050509250925092565b60006124d73361400e565b612549576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f5065726d697373696f6e2064656e69656400000000000000000000000000000081525060200191505060405180910390fd5b60008214156125585760105491505b601160006010548152602001908152602001600020838154811061257857fe5b9060005260206000200154905092915050565b612593613801565b612605576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b6001601b541461267d576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f7665727964616e6765726f75732c206c696d697465642100000000000000000081525060200191505060405180910390fd5b4281116126f2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f6e6f2c207665727964616e6765726f757300000000000000000000000000000081525060200191505060405180910390fd5b806009819055506000601b8190555050565b6000806014836040518082805190602001908083835b6020831061273d578051825260208201915060208101905060208303925061271a565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905060008173ffffffffffffffffffffffffffffffffffffffff161415915050919050565b6127be613801565b612830576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050158015612876573d6000803e3d6000fd5b5050565b612882613801565b6128f4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b61290881600261539f90919063ffffffff16565b50565b612913613801565b612985576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b80600b8190555050565b612997613801565b612a09576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b612a1d81600261545c90919063ffffffff16565b50565b612a28613801565b612a9a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b670de0b6b3a76400004710612afa576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602b815260200180615e14602b913960400191505060405180910390fd5b601060008154809291906001019190505550612b4b62015180612b3d62015180612b2f600e5442614ef590919063ffffffff16565b614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b6009819055506001601b81905550565b612b6b612b66615537565b61400e565b80612b7a5750612b79613801565b5b612bcf576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526040815260200180615ed16040913960400191505060405180910390fd5b61a8c042600854031115612c1857600754471115612c0757612bfc6007544761553f90919063ffffffff16565b600681905550612c10565b60006006819055505b476007819055505b60008290505b8181116135a55760006015600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050600060126000601054815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050612cbb615c6e565b601360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206040518060a0016040529081600082015481526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600282018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612dfe5780601f10612dd357610100808354040283529160200191612dfe565b820191906000526020600020905b815481529060010190602001808311612de157829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612ea05780601f10612e7557610100808354040283529160200191612ea0565b820191906000526020600020905b815481529060010190602001808311612e8357829003601f168201915b50505050508152602001600482015481525050905061a8c0612ecf83600f01544261553f90919063ffffffff16565b11612edc57505050613598565b6000809050600283600801541115612fee576000809050600a846010015410158015612f0c575060148460100154105b15612f2e57612f276064600654614bdf90919063ffffffff16565b9050612fa3565b6014846010015410158015612f475750601e8460100154105b15612f6957612f626032600654614bdf90919063ffffffff16565b9050612fa2565b601e846010015410612fa157612f9e6003612f906064600654614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b90505b5b5b60008090506000809050612fc8612fc38486614ef590919063ffffffff16565b6155c8565b80925081935050506000811115612fea576000879050612fe881836155eb565b505b5050505b4283600f018190555060018260800151141561302d5761301c600184600e0154614ef590919063ffffffff16565b83600e018190555050505050613598565b600083600001541415801561304e5750670de0b6b3a7640000836003015410155b80156130605750601754836003015411155b1561310257600783600b015410156130bf57826006015481019050613092818460070154614ef590919063ffffffff16565b83600701819055506130b2600184600b0154614ef590919063ffffffff16565b83600b0181905550613101565b6130da83600301548460020154614ef590919063ffffffff16565b83600201819055506000836003018190555060008360060181905550600083600801819055505b5b6000613135846004015461312786600201548760030154614ef590919063ffffffff16565b614ef590919063ffffffff16565b9050670de0b6b3a764000081108061314e575060195481115b1561317d5761316b600185600e0154614ef590919063ffffffff16565b84600e01819055505050505050613598565b600080905060008460800151141561348457613197615d4d565b60166000601054815260200190815260200160002060008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600087600e0154815260200190815260200160002060405180606001604052908160008201548152602001600182015481526020016002820154815250509050613241600187600e0154614ef590919063ffffffff16565b86600e0181905550600061326060035485614bdf90919063ffffffff16565b9050600f81106132785781604001518301925061347d565b600187600901541480156132945750670de0b6b3a76400008410155b80156132a4575060008260000151115b156132eb576132e660026132d8836132ca600f8760000151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b830192505b6002876009015414801561330757506753444835ec5800008410155b80156133265750600082600001511180613325575060008260200151115b5b156133d45761337b600a61336d600761335f85613351600f8960000151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b830192506133cf60076133c160056133b3856133a5600f8960200151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b830192505b600387600901541480156133f057506798a7d9b8314c00008410155b8015613400575060008260400151115b156134345761342f81613421600f8560400151614bdf90919063ffffffff16565b614c6e90919063ffffffff16565b830192505b60038760090154101561347c57600061345088600901546145d8565b9050613478600a61346a8387614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b9350505b5b50506134b3565b6002846080015114156134b2576134a9600186600e0154614ef590919063ffffffff16565b85600e01819055505b5b6018546134c98285614ef590919063ffffffff16565b11613591576134e5818660050154614ef590919063ffffffff16565b85600501819055506000809050600080905061351261350d8487614ef590919063ffffffff16565b6155c8565b8092508193505050600081111561358e576000613539600a83614bdf90919063ffffffff16565b9050613567600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16826155eb565b61357a818361553f90919063ffffffff16565b9150600089905061358b81846155eb565b50505b50505b5050505050505b8080600101915050612c1e565b50426008819055505050565b600080600080600080600080600080600080601054600f54600954600c6000601054815260200190815260200160002054600d6000601054815260200190815260200160002054601754601854601954601a54600a5460116000601054815260200190815260200160002080549050601b549b509b509b509b509b509b509b509b509b509b509b509b50909192939495969798999a9b565b6000816040516020018082805190602001908083835b60208310613682578051825260208201915060208101905060208303925061365f565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405160208183030381529060405280519060200120836040516020018082805190602001908083835b602083106136f457805182526020820191506020810190506020830392506136d1565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405160208183030381529060405280519060200120141561373e5760019050613743565b600090505b92915050565b60006137543361400e565b6137c6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f5065726d697373696f6e2064656e69656400000000000000000000000000000081525060200191505060405180910390fd5b6015600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16613844615537565b73ffffffffffffffffffffffffffffffffffffffff1614905090565b61387061386b615537565b61400e565b8061387f575061387e613801565b5b6138d4576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526040815260200180615ed16040913960400191505060405180910390fd5b60008114806138e35750600181145b806138ee5750600281145b613960576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f62616420706172616d657465722073746174757300000000000000000000000081525060200191505060405180910390fd5b6000601360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050818160040181905550505050565b6139b9614a3f565b613a2b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6e6f20646f6e6e6f74696d69746174650000000000000000000000000000000081525060200191505060405180910390fd5b600060126000601054815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050600781600b01541015613afc576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f696e7665737454696d6573206d757374206d6f7265207468616e20370000000081525060200191505060405180910390fd5b60018160100160008282540192505081905550600081600001541415613b8a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f75736572206e6f7420657869737400000000000000000000000000000000000081525060200191505060405180910390fd5b60008160040154826002015401905060008190506000836002018190555060008360040181905550613bc18360030154600161498c565b83600901819055506003546001028110158015613be35750600354600f028111155b613c55576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6265747765656e203120616e642031350000000000000000000000000000000081525060200191505060405180910390fd5b600080613c60614ee8565b15613c6d57829050613c71565b8291505b6000613c8e86600401548760030154614ef590919063ffffffff16565b14613d01576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6f6e6c79206f6e636520696e766573740000000000000000000000000000000081525060200191505060405180910390fd5b818560030181905550808560040181905550613d228560030154600261498c565b8560080181905550613d65613d5e8660040154613d5088600201548960030154614ef590919063ffffffff16565b614ef590919063ffffffff16565b600161498c565b8560090181905550613d966001600c6000601054815260200190815260200160002054614ef590919063ffffffff16565b600c6000601054815260200190815260200160002081905550613dd783600d6000601054815260200190815260200160002054614ef590919063ffffffff16565b600d6000601054815260200190815260200160002081905550613df8614ee8565b613e3757613e0583614f7d565b613e328560010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16614ffc565b613e7b565b601160006010548152602001908152602001600020856000015490806001815401808255809150509060018203906000526020600020016000909192909190915055505b5050505050565b613e92613e8d615537565b61400e565b80613ea15750613ea0613801565b5b613ef6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526040815260200180615ed16040913960400191505060405180910390fd5b80600a8190555050565b6000613f0b3361400e565b613f7d576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f5065726d697373696f6e2064656e69656400000000000000000000000000000081525060200191505060405180910390fd5b6014826040518082805190602001908083835b60208310613fb35780518252602082019150602081019050602083039250613f90565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600061402482600261564090919063ffffffff16565b806140335750614032613801565b5b9050919050565b61404a614045615537565b61400e565b806140595750614058613801565b5b6140ae576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526040815260200180615ed16040913960400191505060405180910390fd5b6001601a5414614126576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f696d706f72742073746f7070656400000000000000000000000000000000000081525060200191505060405180910390fd5b6000601360008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060008160000154146141e3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f7573657220616c7265616479206578697374730000000000000000000000000081525060200191505060405180910390fd5b61424085858080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505060405180602001604052806000815250613649565b156142b3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f656d70747920696e7669746520636f646500000000000000000000000000000081525060200191505060405180910390fd5b6000600f541461438e5761431a83838080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505060405180602001604052806000815250613649565b1561438d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600c8152602001807f656d707479206265436f6465000000000000000000000000000000000000000081525060200191505060405180910390fd5b5b600060148484604051808383808284378083019250505092505050908152602001604051809103902060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508673ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16141561447c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f6265436f6465416464722063616e27742062652073656c66000000000000000081525060200191505060405180910390fd5b6144c986868080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050612704565b1561453c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f696e7669746520636f646520697320757365640000000000000000000000000081525060200191505060405180910390fd5b6145cf8787878080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505086868080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050614d11565b50505050505050565b600060018214156145ec5760039050614615565b60028214156145fe5760069050614615565b600382141561461057600a9050614615565b600090505b919050565b60003390506000813b90506000811461469b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f736f7272792068756d616e73206f6e6c7900000000000000000000000000000081525060200191505060405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff163273ffffffffffffffffffffffffffffffffffffffff161461473c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f736f7272792c2068756d616e73206f6e6c79000000000000000000000000000081525060200191505060405180910390fd5b614744614a3f565b6147b6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6e6f20646f6e6e6f74696d69746174650000000000000000000000000000000081525060200191505060405180910390fd5b600060126000601054815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050600081600001541415614887576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f75736572206e6f7420657869737400000000000000000000000000000000000081525060200191505060405180910390fd5b600b5481601001541015614903576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f7573657220626967206379636c65206c657373207468616e000000000000000081525060200191505060405180910390fd5b60008160040154826002015401905060008090506000809050614925836155c8565b809250819350505060008111801561493f57506019548111155b156149845761494e33826155eb565b60008460020181905550600084600401819055506000846010018190555061497b8460030154600161498c565b84600901819055505b505050505050565b6000805460010283101580156149a757506000546005028311155b156149b55760019050614a39565b60005460060283101580156149cf5750600054600a028311155b156149dd5760029050614a39565b6001821480156149f25750600054600b028310155b15614a005760039050614a39565b600282148015614a155750600054600b028310155b8015614a265750600054600f028311155b15614a345760039050614a39565b600090505b92915050565b60008060095414158015614a54575060095442115b905090565b614a61613801565b614ad3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e657281525060200191505060405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415614b59576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526026815260200180615e3f6026913960400191505060405180910390fd5b80600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b60006001821415614bb15760059050614bda565b6002821415614bc35760079050614bda565b6003821415614bd557600a9050614bda565b600090505b919050565b6000808211614c56576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260088152602001807f646976207a65726f00000000000000000000000000000000000000000000000081525060200191505060405180910390fd5b6000828481614c6157fe5b0490508091505092915050565b600080831415614c815760009050614d0b565b6000828402905082848281614c9257fe5b0414614d06576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600c8152602001807f6d756c206f766572666c6f77000000000000000000000000000000000000000081525060200191505060405180910390fd5b809150505b92915050565b6000601360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050600f60008154809291906001019190505550600f548160000181905550838160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555082816002019080519060200190614dcc929190615d6e565b5081816003019080519060200190614de5929190615d6e565b50836014846040518082805190602001908083835b60208310614e1d5780518252602082019150602081019050602083039250614dfa565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508360156000600f54815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050505050565b600080600a541415905090565b600080828401905083811015614f73576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260088152602001807f6f766572666c6f7700000000000000000000000000000000000000000000000081525060200191505060405180910390fd5b8091505092915050565b600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc614fcd601484614bdf90919063ffffffff16565b9081150290604051600060405180830381858888f19350505050158015614ff8573d6000803e3d6000fd5b5050565b600060126000601054815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050600081600001541415615065575061539c565b60006150748260080154614b9d565b90506150a16103e8615093838560030154614c6e90919063ffffffff16565b614bdf90919063ffffffff16565b8260060181905550600082600b01819055506150bb615c6e565b601360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206040518060a0016040529081600082015481526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600282018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156151fe5780601f106151d3576101008083540402835291602001916151fe565b820191906000526020600020905b8154815290600101906020018083116151e157829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156152a05780601f10615275576101008083540402835291602001916152a0565b820191906000526020600020905b81548152906001019060200180831161528357829003601f168201915b505050505081526020016004820154815250509050670de0b6b3a76400008360030154101580156152d75750601754836003015411155b80156152e7575060008160800151145b156153985761539783600d018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156153875780601f1061535c57610100808354040283529160200191615387565b820191906000526020600020905b81548152906001019060200180831161536a57829003601f168201915b505050505084600301548461571e565b5b5050505b50565b6153a98282615640565b6153fe576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526021815260200180615e8e6021913960400191505060405180910390fd5b60008260000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055505050565b6154668282615640565b156154d9576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f526f6c65733a206163636f756e7420616c72656164792068617320726f6c650081525060200191505060405180910390fd5b60018260000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055505050565b600033905090565b6000828211156155b7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260108152602001807f6c6f77657220737562206269676765720000000000000000000000000000000081525060200191505060405180910390fd5b600082840390508091505092915050565b6000804783106155de57600047915091506155e6565b600183915091505b915091565b600081111561563c578173ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f1935050505015801561563a573d6000803e3d6000fd5b505b5050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614156156c7576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526022815260200180615eaf6022913960400191505060405180910390fd5b8260000160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b60608390506000600190505b60198111615ad65761574b8260405180602001604052806000815250613649565b1561575557615ad6565b60006014836040518082805190602001908083835b6020831061578d578051825260208201915060208101905060208303925061576a565b6001836020036101000a038019825116818451168082178552505050505050905001915050908152602001604051809103902060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690506000601360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050600060126000601054815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020905060006158af82600401546158a184600201548560030154614ef590919063ffffffff16565b614ef590919063ffffffff16565b141561595c57816003018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561594d5780601f106159225761010080835404028352916020019161594d565b820191906000526020600020905b81548152906001019060200180831161593057829003601f168201915b50505050509450505050615ac9565b6000615969600386610f59565b9050600080905067d02ab486cedc0000891161598757889050615993565b67d02ab486cedc000090505b60008214615a245760006159c2836159b48b85614c6e90919063ffffffff16565b614c6e90919063ffffffff16565b90506159ec60646159de6103e884614bdf90919063ffffffff16565b614bdf90919063ffffffff16565b9050615a228560010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168286600e01548a615add565b505b836003018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015615abc5780601f10615a9157610100808354040283529160200191615abc565b820191906000526020600020905b815481529060010190602001808311615a9f57829003601f168201915b5050505050965050505050505b808060010191505061572a565b5050505050565b60008090505b6007811015615bbd57600060166000601054815260200190815260200160002060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000615b558487614ef590919063ffffffff16565b815260200190815260200160002090506001831415615b81578481600001600082825401925050819055505b6002831415615b9d578481600101600082825401925050819055505b848160020160008282540192505081905550508080600101915050615ae3565b5050505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10615bfd5780548555615c3a565b82800160010185558215615c3a57600052602060002091601f016020900482015b82811115615c39578254825591600101919060010190615c1e565b5b509050615c479190615dee565b5090565b604051806101e00160405280600f90602082028038833980820191505090505090565b6040518060a0016040528060008152602001600073ffffffffffffffffffffffffffffffffffffffff1681526020016060815260200160608152602001600081525090565b60405180610220016040528060008152602001600073ffffffffffffffffffffffffffffffffffffffff1681526020016000815260200160008152602001600081526020016000815260200160008152602001600081526020016000815260200160008152602001600081526020016000815260200160608152602001606081526020016000815260200160008152602001600081525090565b60405180606001604052806000815260200160008152602001600081525090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10615daf57805160ff1916838001178555615ddd565b82800160010185558215615ddd579182015b82811115615ddc578251825591602001919060010190615dc1565b5b509050615dea9190615dee565b5090565b615e1091905b80821115615e0c576000816000905550600101615df4565b5090565b9056fe636f6e74726163742062616c616e6365206d757374206265206c6f776572207468616e20312065746865724f776e61626c653a206e6577206f776e657220697320746865207a65726f20616464726573735065726d697373696f6e2064656e69656420666f722076696577207573657227732070726976616379526f6c65733a206163636f756e7420646f6573206e6f74206861766520726f6c65526f6c65733a206163636f756e7420697320746865207a65726f206164647265737357686974656c69737441646d696e526f6c653a2063616c6c657220646f6573206e6f742068617665207468652057686974656c69737441646d696e20726f6c65a265627a7a723158201b04e436f7973257b6d6873e0d68b3140e200a97b6628689798809969eb0521b64736f6c63430005110032";


  public final static String simple2InitCode = "6080604052348015600f57600080fd5b5060888061001e6000396000f3fe";
  public final static String simple2 = "6080604052348015600f57600080fd5b506004361060285760003560e01c8063b3b36bb314602d575b600080fd5b6033604f565b604080516001600160a01b039092168252519081900360200190f35b339056fea265627a7a72305820d0580d02f8b3b87961ca09a1b9e6c17f6e5c8da00dfaaa77232a4b4f8790ee6c64736f6c634300050a0032";

  public final static String simple3InitCode = "608060405234801561001057600080fd5b5060d08061001f6000396000f3fe";
  public final static String simple3 = "6080604052348015600f57600080fd5b5060043610603c5760003560e01c806395cacbe0146041578063c0406226146059578063c82fdf36146061575b600080fd5b60476067565b60408051918252519081900360200190f35b605f606d565b005b60476095565b60015481565b60015460008054909101905b81811015609157600080546001908101909155016079565b5050565b6000548156fea265627a7a723058207e4e4638ea82c24f05e54b02af9a29861f8ab74de766cdb4625b3023fda63bae64736f6c634300050a0032";


  public static void main(String[] args) throws Exception {
    LOG.info("TODO: compare against the size of the contract.");
    LOG.info("TODO: add size of proofs to overall calculation");
    LOG.info("TODO: add support for calls.");
    LOG.info("TODO: add support for contract data.");


    new WitnessCodeAnalysis().doStuff();
  }

  public void doStuff() throws Exception {
//    Bytes code = Bytes.fromHexString(contract_0xd94ea6e43b7bffc9e4cba93f3ca49a191dc06d90);
    Bytes code = Bytes.fromHexString(simple3);
    runAllAnalyses(code);
  }

  public void runAllAnalyses(Bytes code) {
    int ofsAuxData = AuxData.offsetOfAuxData(code);
    LOG.info("Offset Aux Data: {}", ofsAuxData);

    SimpleAnalysis simple = new SimpleAnalysis(code);
    boolean probablySolidity = simple.probablySolidity();
    LOG.info("Probably Solidity: {}", probablySolidity);

    int probableEndOfCode = (ofsAuxData == 0) ? code.size() : ofsAuxData;

    Set<Bytes> functionIds = simple.determineFunctionIds(probableEndOfCode);
    if (functionIds.size() == 0) {
      LOG.info("No functions found");
    }
    for (Bytes functionId: functionIds) {
      LOG.info("Function Id: {}", functionId);
    }


    // Find all of the code segments in a contract.
    CodePaths codePaths = new CodePaths(code);
    codePaths.findAllCodePaths();
    for (CodeSegment codeSegment: codePaths.codeSegments.values()) {
      LOG.info(codeSegment);
    }
    boolean codePathsValid = codePaths.validateCodeSegments(probableEndOfCode);
    LOG.info("Code Paths Valid: {}", codePathsValid);
    if (!codePathsValid) {
      return;
    }

    // Find which code segments belong to which function.
    for (Bytes functionId: codePaths.foundFunctions.keySet()) {
      codePaths.findCodeSegmentsForFunction(functionId, codePaths.foundFunctions.get(functionId));
    }
    boolean noUnusedCodePaths = codePaths.checkForUnusedCodeSegments();
    LOG.info("All Code Paths Used: {}", noUnusedCodePaths);
    if (!noUnusedCodePaths) {
      return;
    }

    int COMBINATION_GAP = 4;
    LOG.info("Combining Code Segments using bytes between segments: {}", COMBINATION_GAP);
    codePaths.combineCodeSegments(COMBINATION_GAP);

    codePaths.showCombinedCodeSegments();

    codePaths.estimateWitnessSize();



  }
}
